name: Auto Release Translation Pack

on:
  push:
    branches: [ l10n_main2 ]  # Trigger bei Push auf main branch
  workflow_dispatch:  # Manueller Trigger

concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Create Release ZIP
        run: |
          zip -r dayofmind-translation.zip . -x "*.git*" "*.github*"
      
      - name: Delete Previous Release
        run: |
          gh release delete latest --yes || true
          git push --delete origin latest || true
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      
      - name: Create New Release
        run: |
          gh release create latest dayofmind-translation.zip \
            --title "Latest Translation Pack" \
            --notes "Auto-generated translation pack from latest changes" \
            --latest
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
